## General

This custom error handler plugin allows a single module to process error messages from multiple types:

- Error types default to mule. (HTTP, APIKIT, Connectors based, etc)
- custom error types as defined by raise error component.
- Un-clutter exceptions both in UI and XML
- User can change the custom error message (for multiple errors) in the UI rather than in the XML.
- Users intending to use other error types should put them on on-error-propagate or on-error-continue prior to using this module.
- No specific error type is required for this module. It can parse any error types.
- Support for Mule error components to be factored into the error message based on boolean fields.
- Using Mule Error components will give very prescriptive error messages.

## Using the module in a Mule4 Project

Add this dependency to your application pom.xml

```
<dependency>
    <groupId>${groupId}</groupId>
    <artifactId>error-handler-plugin</artifactId>
    <version>${version}</version>
    <classifier>mule-plugin</classifier>
</dependency>
```

## Usage

- Delete the auto-generated error blocks (on-error-propagate/on-error-continue) before using this module.
- Place the plugin inside an error block (on-error-propagate/on-error-continue) along with a variable for httpStatus.
- httpStatus will be back like `attributes.httpStatus` on the plugin response.

## Tabs

### General

- Takes value for the previous error message that needs to be propagated. It has to be of type `object`.
- The error section defines from what mule expression should the error be read.

### Common Errors

Common HTTP-based errors are defined in this section. Users have to provide the message they want to send back on the API error response.

A boolean field `Default Error Description` has been enabled. If this is set to true, then the error message will be taken from the error description generated by Mule.

If the field is set to false, then whatever literal value is provided on the UI will be used to populate the error message.

The default value is `true`.

### Custom Errors (`,` Delimited)

Custom errors are now supported through a user-defined JSON or Dataweave File. Users can provide the file through the custom error content section. The default value is `{}`.

Create a custom errors file inside src/main/resources and then reference it as `${file::dwl/customErrors.dwl}`. The sample content of the file is provided below.

```
<![CDATA[#[${file::dwl/customErrors.dwl}]]]>>
```

A copy of the file is included in the source code of the plugin. The file is called `sampleCustomErrors.dwl`.

**Sample Content**

```
%dw 2.0
output application/java
{

    "VALIDATION:INVALID_BOOLEAN": {
        "errorCode": 500,
        "reason": "UNKNOWN",
        "ErrorMessage": error.description, // read error from the application
        "additionalInfo": "add any info" // this field is optional
    }
}
```

### CorrelationId

A correlationId will be used for tracking transactions. The default value is #[correlationId]

## Sample Usage

### On Error With Default Errors

```
<error-handler-plugin:on-error doc:name="Process Error" doc:id="5cb355ae-9e1e-4ca8-971e-a63eca2e4c54" config-ref="ErrorHandlerPluginConfig" />
```

## Deploy on Exchange

This deploy requires the following 2 arguments in the following order:

1. Replace the groupId in pom.xml to your Anypoint Platform orgId
2. Make sure that the .m2/settings.xml is configured with Exchange credentials as the example below:

```
<server>
    <id>Exchange2</id>
    <username>ANYPOINT_PLATFORM_USER</username>
    <password>ANYPOINT_PLATFORM_PASS</password>
</server>
```

_**The id used need same to **_`distributionManagement`_** in pom.xml**_

```
mvn clean deploy
```

## Original Plugin

[https://github.com/mulesoft-catalyst/error-handler-plugin](https://github.com/mulesoft-catalyst/error-handler-plugin)
